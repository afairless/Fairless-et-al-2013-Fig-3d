{
    "contents" : "# Andrew Fairless, August 2011\n# modified May 2015 for posting onto Github\n# This script constructs the bar graph for Figure 3c of Fairless et al 2013\n# Fairless et al 2013, doi: 10.1016/j.bbr.2012.08.051, PMID: 22982070, PMCID: PMC3554266\n\ninstall.packages(\"gplots\", dependencies = TRUE)        # install package if not already installed\n\nlibrary(gplots)\nsource(\"barplot2af.txt\")                               # contains modified barplot2 function\n\nbargraphtable = read.table(\"bargraphtable.txt\", header = TRUE, sep = \"\\t\")           # table of parameters for bar graph\nbars = t(bargraphtable[ ,5])                           # heights of the bars (group means)\nlowerrbar = bargraphtable[ ,5]-bargraphtable[ ,6]      # lower error bar\nupperrbar = bargraphtable[ ,5] + bargraphtable[ ,6]    # upper error bar\nbarcolors = as.vector(t(bargraphtable[ ,7]))\nbtwnbarspace = bargraphtable$btwnspace                 # specifies amount of open space to the left of each bar\ntkmks = seq(0, 100, by = 10)                           # tickmarks for left-hand y-axis \ntkmks2 = seq(0, 45, by = 5)                            # tickmarks for right-hand y-axis \nxlabels = rep(c(\"female\", \"female\", \"   male\", \"   male\"), 3)\nbarmidpoints = c(2.1, 3.1, 4.9, 5.9, 8.5, 9.5, 11.3, 12.3, 14.9, 15.9, 17.7, 18.7)   # horizontal positions of bars\nleg1 = c(barcolors[1], barcolors[2])                   # legend colors\nleg2 = c(\"C57BL/6J\", \"BALB/cJ\")                        # legend labels\nlwd = 2                       # line width\nsexverticaloffset = 1         # vertical position of \"male\" and \"female\" x-axis labels\nageverticaloffset = 2.5       # vertical position of age x-axis labels\nxlabelcex = 1.3               # x-axis labels size\nuppery = 75                   # vertical position of top of graph\n\n\npng(file = \"rearing bar graph.png\", width = 640, height = 512)\t\npar(mar = c(5.1, 4.1, 4.1, 4.1))\nbarplot2af(as.vector(bars), plot.ci = TRUE, ci.l = lowerrbar, ci.u = upperrbar, \n           ci.lwd = lwd, col = barcolors, space = btwnbarspace, \n           ylab = \"Portion (%) of all scored time points\", names.arg = NULL, \n           cex.names = 1.5, las = 2, yaxt = \"n\", cex.lab = 1.5, ylim = c(0, uppery))\nabline(h = 0, lwd = lwd)\naxis(1, at = c(7.2, 13.6), las = 2, lwd = lwd, labels = c(\"\", \"\"), tck = -0.1)\naxis(2, at = tkmks, las = 2, lwd = lwd, cex.axis = 1.6)\naxis(4, at = tkmks2/0.61, las = 2, lwd = lwd, cex.axis = 1.6, labels = tkmks2)\npar(xpd = T) \ntext(21.7, 37.5, \"Number of time points\", cex = 1.5, srt = 270)\npar(xpd = F)\npar(font = 2)\nlegend(2, uppery, leg2, fill = leg1, cex = 1.0, bty = \"o\")\npar(font = 1)\ntext(4.0, labels = \"30 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, \n     offset = ageverticaloffset, font = 2)\ntext(10.4, labels = \"41 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, \n     offset = ageverticaloffset, font = 2)\ntext(16.8, labels = \"69 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, \n     offset = ageverticaloffset, font = 2)\ntext(c(2.6, 9.0, 15.4), labels = \"female\", par(\"usr\")[3], pos = 1, xpd = T, \n     cex = xlabelcex, offset = sexverticaloffset, font = 2)\ntext(c(5.4, 11.8, 18.2), labels = \"male\", par(\"usr\")[3], pos = 1, xpd = T, \n     cex = xlabelcex, offset = sexverticaloffset, font = 2)\n\n# plots lines and asterisk denoting statistical significance between groups\n# for 30-day-old group\nlwd = 3\nbar1 = 1\nbar2 = 2\nbar3 = 3\nbar4 = 4\nbar1mid = barmidpoints[bar1]\nbar2mid = barmidpoints[bar2]\nbar3mid = barmidpoints[bar3]\nbar4mid = barmidpoints[bar4]\ngap = 1.5\ncrossbarheight1 = max(upperrbar[bar1:bar4]) + (gap * 4)\ncrossbarheight2 = max(upperrbar[bar1:bar4]) + (gap * 6)\nstarx = mean(rbind(barmidpoints[bar1], barmidpoints[bar2], barmidpoints[bar3], barmidpoints[bar4]))\nstary = max(crossbarheight1, crossbarheight2) + (abs(crossbarheight2 - crossbarheight1) * 1.5)\n\nsegments(barmidpoints[bar1], (upperrbar[bar1] + gap), barmidpoints[bar1], crossbarheight1, lwd = lwd)\nsegments(barmidpoints[bar2], (upperrbar[bar2] + gap), barmidpoints[bar2], crossbarheight2, lwd = lwd)\nsegments(barmidpoints[bar3], (upperrbar[bar3] + gap), barmidpoints[bar3], crossbarheight1, lwd = lwd)\nsegments(barmidpoints[bar4], (upperrbar[bar4] + gap), barmidpoints[bar4], crossbarheight2, lwd = lwd)\nsegments(barmidpoints[bar1], crossbarheight1, barmidpoints[bar3], crossbarheight1, lwd = lwd)\nsegments(barmidpoints[bar2], crossbarheight2, barmidpoints[bar4], crossbarheight2, lwd = lwd)\nsegments(mean(rbind(barmidpoints[bar1], barmidpoints[bar3])), crossbarheight1, starx, stary, lwd = lwd)\nsegments(mean(rbind(barmidpoints[bar2], barmidpoints[bar4])), crossbarheight2, starx, stary, lwd = lwd)\ntext(starx, (stary + (gap * 2.5)), labels = \"*\", cex = 6)\n\n# plots lines and asterisk denoting statistical significance between groups\n# for 69-day-old group\nlwd = 3\nbar1 = 9\nbar2 = 10\nbar3 = 11\nbar4 = 12\nbar1mid = barmidpoints[bar1]\nbar2mid = barmidpoints[bar2]\nbar3mid = barmidpoints[bar3]\nbar4mid = barmidpoints[bar4]\ngap = 1.5\ncrossbarheight1 = max(upperrbar[bar1:bar4]) + (gap * 4)\ncrossbarheight2 = max(upperrbar[bar1:bar4]) + (gap * 6)\nstarx = mean(rbind(barmidpoints[bar1], barmidpoints[bar2], barmidpoints[bar3], barmidpoints[bar4]))\nstary = max(crossbarheight1, crossbarheight2) + (abs(crossbarheight2 - crossbarheight1) * 1.5)\n\nsegments(barmidpoints[bar1], (upperrbar[bar1] + gap), barmidpoints[bar1], crossbarheight1, lwd = lwd)\nsegments(barmidpoints[bar2], (upperrbar[bar2] + gap), barmidpoints[bar2], crossbarheight2, lwd = lwd)\nsegments(barmidpoints[bar3], (upperrbar[bar3] + gap), barmidpoints[bar3], crossbarheight1, lwd = lwd)\nsegments(barmidpoints[bar4], (upperrbar[bar4] + gap), barmidpoints[bar4], crossbarheight2, lwd = lwd)\nsegments(barmidpoints[bar1], crossbarheight1, barmidpoints[bar3], crossbarheight1, lwd = lwd)\nsegments(barmidpoints[bar2], crossbarheight2, barmidpoints[bar4], crossbarheight2, lwd = lwd)\nsegments(mean(rbind(barmidpoints[bar1], barmidpoints[bar3])), crossbarheight1, starx, stary, lwd = lwd)\nsegments(mean(rbind(barmidpoints[bar2], barmidpoints[bar4])), crossbarheight2, starx, stary, lwd = lwd)\ntext(starx, (stary + (gap * 2.5)), labels = \"*\", cex = 6)\n\ndev.off()\t\n",
    "created" : 1452016637476.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "688901299",
    "id" : "73D893CF",
    "lastKnownWriteTime" : 1432522614,
    "path" : "~/Link to backup/2015 code share/Fairless et al 2013 Fig 3d/to share/revising.R",
    "project_path" : "revising.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}